---
name: mirror-writing-generation
description: 【工作流内部阶段】基于前序阶段输出生成短视频口播文案，支持配置时长和数量
allowed-tools: Read, Write, Glob
---

# 阶段4：选题与文案生成

> 运行频率：每次创作时运行，接在阶段3之后
> 输入：阶段1画像 + 阶段3关键词云 + 知识库匹配内容
> 输出：选题方案 + 完整的短视频口播文案

## 路径约定

- **会话路径**: `$SESSION_PATH`（由主协调子代理传递）
- **画像路径**: `./.mirror-writing/profile.md`（全局）
- **索引路径**: `./.mirror-writing/_index.json`（全局，用于相关内容检索）
- **关键词云路径**: `$SESSION_PATH/keywords.md`
- **L3路径**: `$SESSION_PATH/deep-dive.md`（如有）
- **知识库路径**: 当前工作目录
- **输出路径**: `$SESSION_PATH/outputs.md`

## 执行前检查

1. 读取 `.mirror-writing/profile.md`（创作者画像）
2. 读取 `$SESSION_PATH/keywords.md`
3. 如有 `$SESSION_PATH/deep-dive.md`，一并读取
4. **相关内容匹配**（索引优先策略）：
   - 若 `_index.json` 存在：
     1. 从 `keywords.md` 提取5-10个核心关键词
     2. 在 `_index.json.global_index.keyword_to_files` 中检索
     3. 按匹配次数排序，取前2-5篇文件
     4. 读取匹配文件的原文内容
   - 若 `_index.json` 不存在：
     1. 根据关键词直接搜索当前目录txt文件
     2. 选取相关度最高的2-5篇

## 创作参数

以下参数使用默认值（可由主协调子代理传递覆盖）：

| 参数 | 默认值 | 可选值 |
|-----|-------|------|
| 目标时长 | 90秒 | 60/90/120/180/300秒 |
| 生成数量 | 5个 | 1-10 |

### 时长与字数对照

| 时长 | 字数（建议） | 说明 |
|-----|------------|------|
| 60秒 | 160-200字 | 标准版，最常用 |
| 90秒 | 250-280字 | 完整版，适合复杂话题 |
| 120秒 | 320-380字 | 深度版，适合故事型 |
| 180秒 | 450-520字 | 深度版，适合故事型 |
| 300秒 | 600-700字 | 深度版，适合故事型 |

*注：按每秒3字的口播速度估算*

## 创作原则

- **风格一致性**: 文案读起来要像是原创作者写的
- **结构规范性**: 遵循被验证有效的内容结构
- **原创性**: 借鉴风格而非复制内容
- **共鸣性**: 内容要能引发目标受众的情感共鸣

### 创作禁忌
- 不要直接复制原文案内容
- 不要使用明显的AI痕迹（如：总之、综上所述、作为AI）
- 不要偏离创作者的核心价值观

## 创作流程

### Step 1: 选题确定
从关键词云和创意火花中，提炼出指定数量的具体选题。每个选题需要：
- 一句话标题
- 核心观点（20字内）
- 情感定位
- 目标受众

### Step 2: 结构设计
根据画像中的结构范式，为每个选题设计内容结构：
- 开头钩子（占10-15%）
- 正文展开（占60-70%）
- 高潮/亮点（占10-15%）
- 结尾收束（占10-15%）

### Step 3: 文案撰写
按照设计好的结构撰写完整文案，注意：
- 使用画像中的语气和用词习惯
- 自然融入关键词云中的词汇
- 控制字数符合目标时长

### Step 4: 质量自检
对照检查：
- [ ] 开头是否抓人
- [ ] 结构是否清晰
- [ ] 语气是否一致
- [ ] 时长是否合适
- [ ] 有无明显AI痕迹

## 风格融合（可选）

如果用户指定跨风格融合：

| 参数 | 说明 |
|-----|------|
| 开头模式来源 | 使用哪个博主的开头模式 |
| 正文结构来源 | 使用哪个博主的展开逻辑 |
| 金句风格来源 | 参考谁的金句风格 |
| 结尾模式来源 | 使用哪个博主的结尾模式 |
| 整体语气来源 | 以谁的语气为主基调 |

注意事项：
- 选定一个博主作为"主风格"，其他作为点缀
- 不同模块之间需要平滑过渡
- 融合的博主价值观不能冲突

## 输出格式

对于每个选题，按以下格式输出：

---

### 选题 1: [选题标题]

#### 选题信息
| 项目 | 内容 |
|-----|------|
| 核心观点 | [20字内] |
| 情感定位 | [如：温暖励志/犀利吐槽] |
| 目标受众 | [受众描述] |
| 预计时长 | [XX秒] |
| 预计字数 | [XXX字] |

#### 结构设计
| 部分 | 占比 | 设计说明 |
|-----|------|---------|
| 开头 | 15% | [采用什么开头方式] |
| 正文 | 60% | [采用什么展开方式] |
| 高潮 | 10% | [亮点设计] |
| 结尾 | 15% | [采用什么结尾方式] |

#### 口播文案

[完整的口播文案，带标点符号，适合直接使用]

#### 使用的关键词
[列出文案中使用的关键词云词汇]

---

保存到 `$SESSION_PATH/outputs.md`

## 迭代优化

第一版文案生成后，可以追加指令：

```
# 风格强化
请按照以下调整优化文案：
- 开头再犀利一点
- 多用短句
- 语气更温暖一些

# 换个角度
保持同样的风格，但换一个切入角度重写开头

# 压缩版本
把当前文案压缩到30秒版本，保留核心观点

# 扩展版本
把当前文案扩展到90秒，增加一个案例/故事
```
